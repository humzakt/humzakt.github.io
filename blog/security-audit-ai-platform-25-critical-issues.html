<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>I Audited Our AI Platform and Found Critical Security Gaps — Humza Tareen</title>
  <meta name="description" content="A systematic security audit of a production AI evaluation platform revealed SQL injection, hardcoded credentials, and a monolithic God Class. Here's the methodology and fixes.">
  <meta name="author" content="Humza Tareen">
  <meta name="keywords" content="Security, Audit, Cloud Security, SQL Injection, GCP, Python, Production Hardening">
  <link rel="canonical" href="https://humzakt.github.io/blog/security-audit-ai-platform-25-critical-issues.html">
  <meta property="og:title" content="I Audited Our AI Platform and Found Critical Security Gaps">
  <meta property="og:description" content="A systematic security audit of a production AI evaluation platform revealed SQL injection, hardcoded credentials, and a monolithic God Class. Here's the methodology and fixes.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://humzakt.github.io/blog/security-audit-ai-platform-25-critical-issues.html">
  <meta property="og:image" content="https://humzakt.github.io/suit-blue-bg.jpg">
  <meta property="og:site_name" content="Humza Tareen">
  <meta property="article:published_time" content="2026-02-08T00:00:00Z">
  <meta property="article:author" content="Humza Tareen">
  <meta property="article:tag" content="Security">
  <meta property="article:tag" content="GCP">
  <meta property="article:tag" content="Cloud Security">
  <meta property="article:tag" content="Python">
  <meta property="article:tag" content="DevOps">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="I Audited Our AI Platform and Found Critical Security Gaps">
  <meta name="twitter:description" content="A systematic security audit of a production AI evaluation platform revealed SQL injection, hardcoded credentials, and a monolithic God Class. Here's the methodology and fixes.">
  <meta name="twitter:image" content="https://humzakt.github.io/suit-blue-bg.jpg">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "I Audited Our AI Platform and Found Critical Security Gaps",
    "description": "A systematic security audit of a production AI evaluation platform revealed SQL injection, hardcoded credentials, and a monolithic God Class. Here's the methodology and fixes.",
    "image": "https://humzakt.github.io/suit-blue-bg.jpg",
    "author": { "@type": "Person", "name": "Humza Tareen", "url": "https://humzakt.github.io" },
    "publisher": { "@type": "Person", "name": "Humza Tareen" },
    "datePublished": "2026-02-08",
    "dateModified": "2026-02-08",
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://humzakt.github.io/blog/security-audit-ai-platform-25-critical-issues.html" },
    "keywords": ["Security", "GCP", "Cloud Security", "Python", "DevOps"],
    "articleSection": "Security"
  }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
  <link rel="stylesheet" href="../styles.css">
  <link rel="alternate" type="application/rss+xml" title="Humza Tareen Blog" href="https://humzakt.github.io/blog/feed.xml">
  <style>
    .blog-post { max-width: 800px; margin: 0 auto; padding: calc(var(--nav-height) + 40px) 24px 80px; }
    .blog-back { display: inline-flex; align-items: center; gap: 8px; color: var(--accent); font-family: var(--font-mono); font-size: 14px; margin-bottom: 32px; }
    .blog-back:hover { gap: 12px; }
    .blog-header { margin-bottom: 40px; }
    .blog-title { font-size: clamp(28px, 5vw, 42px); color: var(--heading); line-height: 1.2; margin-bottom: 16px; font-weight: 700; }
    .blog-meta { display: flex; flex-wrap: wrap; align-items: center; gap: 16px; color: var(--text); font-size: 14px; font-family: var(--font-mono); margin-bottom: 24px; }
    .blog-meta time { color: var(--accent); }
    .blog-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 24px; }
    .blog-tag { font-size: 12px; padding: 4px 12px; border-radius: 20px; background: rgba(100,255,218,0.08); color: var(--accent); font-family: var(--font-mono); }
    .blog-content { color: var(--text-light); line-height: 1.8; font-size: 17px; }
    .blog-content h2 { color: var(--heading); font-size: 24px; margin: 48px 0 16px; font-weight: 600; }
    .blog-content h3 { color: var(--heading); font-size: 20px; margin: 32px 0 12px; font-weight: 600; }
    .blog-content p { margin-bottom: 20px; }
    .blog-content ul, .blog-content ol { margin-bottom: 20px; padding-left: 24px; }
    .blog-content li { margin-bottom: 8px; }
    .blog-content strong { color: var(--heading); font-weight: 600; }
    .blog-content code { font-family: var(--font-mono); font-size: 0.9em; background: var(--bg-light); padding: 2px 6px; border-radius: 4px; color: var(--accent); }
    .blog-content pre { background: var(--bg-light); border: 1px solid var(--card-border); border-radius: 8px; padding: 20px; overflow-x: auto; margin-bottom: 24px; font-size: 14px; line-height: 1.6; }
    .blog-content pre code { background: none; padding: 0; color: var(--text-light); }
    .blog-content a { color: var(--accent); text-decoration: underline; text-underline-offset: 3px; }
    .blog-content a:hover { color: var(--heading); }
    .blog-content table { width: 100%; border-collapse: collapse; margin-bottom: 24px; font-size: 15px; }
    .blog-content th, .blog-content td { padding: 12px 16px; border: 1px solid var(--card-border); text-align: left; }
    .blog-content th { background: var(--bg-light); color: var(--heading); font-weight: 600; }
    .blog-footer { margin-top: 60px; padding-top: 32px; border-top: 1px solid var(--card-border); }
    .blog-author { display: flex; align-items: center; gap: 16px; }
    .blog-author-img { width: 56px; height: 56px; border-radius: 50%; object-fit: cover; }
    .blog-author-info h4 { color: var(--heading); font-size: 16px; }
    .blog-author-info p { color: var(--text); font-size: 14px; }
    .blog-cta { margin-top: 32px; text-align: center; }
    .blog-cta a { display: inline-block; padding: 12px 28px; border: 1px solid var(--accent); color: var(--accent); border-radius: 6px; font-family: var(--font-mono); font-size: 14px; transition: var(--transition); }
    .blog-cta a:hover { background: var(--accent-muted); }
    @media (max-width: 768px) { .blog-post { padding-top: calc(var(--nav-height) + 20px); } .blog-content { font-size: 16px; } }
  </style>
</head>
<body>
  <nav class="nav" id="nav" aria-label="Main navigation">
    <a href="../index.html" class="nav-logo" aria-label="Humza Tareen - Home">HT</a>
    <div class="nav-links" role="list">
      <div class="page-switcher">
        <a href="../engineering.html">Engineering</a>
        <a href="../research.html">Research</a>
      </div>
      <a href="../engineering.html#articles" role="listitem">All Articles</a>
      <a href="../engineering.html#contact" class="nav-cta" role="listitem">Hire Me</a>
    </div>
  </nav>
  <main class="blog-post">
    <a href="../engineering.html#articles" class="blog-back"><i class="fas fa-arrow-left"></i> All Articles</a>
    <article>
      <header class="blog-header">
        <h1 class="blog-title">I Audited Our AI Platform and Found Critical Security Gaps</h1>
        <div class="blog-meta">
          <time datetime="2026-02-08">Feb 8, 2026</time>
          <span>&middot;</span>
          <span>7 min read</span>
          <span>&middot;</span>
          <span>Humza Tareen</span>
        </div>
        <div class="blog-tags">
          <span class="blog-tag">Security</span>
          <span class="blog-tag">GCP</span>
          <span class="blog-tag">Cloud Security</span>
          <span class="blog-tag">Python</span>
          <span class="blog-tag">DevOps</span>
        </div>
      </header>
      <div class="blog-content">
        
        <p>Six months of shipping fast had created something nobody wanted to talk about: security debt. I decided to spend two days auditing the entire platform systematically. What I found was sobering.</p>

        <h2>The Audit Methodology</h2>
        <p>I approached it service by service, starting with the most exposed: the API gateway and evaluation engine. For each service, I examined five categories: input validation, authentication, secrets management, logging hygiene, and architecture boundaries. I wasn't looking for perfection—I was looking for production incidents waiting to happen.</p>

        <h2>What I Found</h2>
        <p>The BigQuery f-string SQL injection was the first red flag. A developer had used f-strings for dynamic table names, which works fine in development but is catastrophic in production. The query looked innocent: <code>f"SELECT * FROM {table_name}"</code>. But table_name came from user input, and BigQuery doesn't sanitize f-strings. One malicious payload could have exposed our entire evaluation dataset.</p>

        <p>Then I found the alembic.ini credentials. Database migration config committed with hardcoded passwords. Anyone with repository access had production database credentials. This wasn't a theoretical risk—it was a live vulnerability sitting in our git history.</p>

        <p>The CI/CD log leak was subtler. API keys were being printed during build steps, visible to anyone with repo access. The logs weren't public, but they didn't need to be. Internal access was enough.</p>

        <p>Three endpoints had no authentication because they were "only called by other services." The "internal = safe" assumption. In a microservices architecture, internal doesn't mean secure. It means accessible to any compromised service or misconfigured network policy.</p>

        <p>PII in logs was the compliance nightmare. User emails and evaluation data in plaintext application logs. GDPR violations waiting to happen, and we were generating them by the thousands.</p>

        <h2>The Monolithic God Class</h2>
        <p>Beyond security, there was architecture debt. A monolithic ParallelOrchestrator handling evaluation logic, API routing, state management, and error handling. V1/V2 code boundaries leaked into each other. In-memory rate limiting that doesn't work across Cloud Run instances—each instance had its own counter, so rate limits were effectively divided by instance count. CPU-bound algorithms blocking the async event loop, turning our FastAPI app into a synchronous bottleneck.</p>

        <h2>The Remediation</h2>
        <p>All secrets moved to GCP Secret Manager. Here's what changed:</p>

<pre><code># Before
DATABASE_PASSWORD = "hardcoded_password_123"

# After
from google.cloud import secretmanager
client = secretmanager.SecretManagerServiceClient()
secret = client.access_secret_version(
    name="projects/my-project/secrets/db-password/versions/latest"
)
DATABASE_PASSWORD = secret.payload.data.decode("UTF-8")</code></pre>

        <p>Parameterized queries everywhere. No more f-strings in SQL. Here's the pattern we enforced:</p>

<pre><code># Before (vulnerable)
query = f"SELECT * FROM {table_name} WHERE id = {user_id}"

# After (safe)
query = "SELECT * FROM %s WHERE id = %s"
cursor.execute(query, (table_name, user_id))</code></pre>

        <p>Structured logging with PII stripping middleware. Every log entry goes through a sanitizer that removes emails, API keys, and user identifiers before writing to disk. Authentication middleware on every endpoint—no exceptions. Pre-commit hooks: ruff for linting, type checking, security scanning with bandit.</p>

        <p>We broke the God Class into focused services: EvaluationService, RoutingService, StateService, ErrorHandler. Built an LLM Gateway abstraction so we could swap providers without touching business logic. Moved rate limiting to Redis so it works across instances. Wrapped CPU-bound work in thread pools so the event loop stays responsive.</p>

        <h2>The Takeaway</h2>
        <p>The two days I spent auditing saved us from at least three potential production incidents. Schedule security audits. Don't wait for an incident. Security debt compounds silently, and the longer you ignore it, the more expensive it becomes to fix.</p>
        
      </div>
      <footer class="blog-footer">
        <div class="blog-author">
          <img src="../suit-blue-bg.jpg" alt="Humza Tareen" class="blog-author-img">
          <div class="blog-author-info">
            <h4>Humza Tareen</h4>
            <p>AI Engineer building production systems at scale. <a href="../engineering.html">View full portfolio</a></p>
          </div>
        </div>
        <div class="blog-cta">
          <a href="../engineering.html#articles">Read More Articles</a>
        </div>
      </footer>
    </article>
  </main>
</body>
</html>