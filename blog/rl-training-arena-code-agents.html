<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Building an RL Training Arena for AI Code Agents on GCP — Humza Tareen</title>
  <meta name="description" content="How we built a reinforcement learning environment for training AI coding agents using GKE, Cloud Build sandboxing, Redis, and Firestore.">
  <meta name="author" content="Humza Tareen">
  <meta name="keywords" content="Reinforcement Learning, AI, GKE, Cloud Build, Redis, Firestore, Python, Machine Learning">
  <link rel="canonical" href="https://humzakt.github.io/blog/rl-training-arena-code-agents.html">
  <meta property="og:title" content="Building an RL Training Arena for AI Code Agents on GCP">
  <meta property="og:description" content="How we built a reinforcement learning environment for training AI coding agents using GKE, Cloud Build sandboxing, Redis, and Firestore.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://humzakt.github.io/blog/rl-training-arena-code-agents.html">
  <meta property="og:image" content="https://humzakt.github.io/suit-blue-bg.jpg">
  <meta property="og:site_name" content="Humza Tareen">
  <meta property="article:published_time" content="2026-02-08T00:00:00Z">
  <meta property="article:author" content="Humza Tareen">
  <meta property="article:tag" content="Reinforcement Learning">
  <meta property="article:tag" content="AI">
  <meta property="article:tag" content="GKE">
  <meta property="article:tag" content="Cloud Build">
  <meta property="article:tag" content="Python">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Building an RL Training Arena for AI Code Agents on GCP">
  <meta name="twitter:description" content="How we built a reinforcement learning environment for training AI coding agents using GKE, Cloud Build sandboxing, Redis, and Firestore.">
  <meta name="twitter:image" content="https://humzakt.github.io/suit-blue-bg.jpg">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Building an RL Training Arena for AI Code Agents on GCP",
    "description": "How we built a reinforcement learning environment for training AI coding agents using GKE, Cloud Build sandboxing, Redis, and Firestore.",
    "image": "https://humzakt.github.io/suit-blue-bg.jpg",
    "author": { "@type": "Person", "name": "Humza Tareen", "url": "https://humzakt.github.io" },
    "publisher": { "@type": "Person", "name": "Humza Tareen" },
    "datePublished": "2026-02-08",
    "dateModified": "2026-02-08",
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://humzakt.github.io/blog/rl-training-arena-code-agents.html" },
    "keywords": ["Reinforcement Learning", "AI", "GKE", "Cloud Build", "Python"],
    "articleSection": "ML Infrastructure"
  }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
  <link rel="stylesheet" href="../styles.css">
  <link rel="alternate" type="application/rss+xml" title="Humza Tareen Blog" href="https://humzakt.github.io/blog/feed.xml">
  <style>
    .blog-post { max-width: 800px; margin: 0 auto; padding: calc(var(--nav-height) + 40px) 24px 80px; }
    .blog-back { display: inline-flex; align-items: center; gap: 8px; color: var(--accent); font-family: var(--font-mono); font-size: 14px; margin-bottom: 32px; }
    .blog-back:hover { gap: 12px; }
    .blog-header { margin-bottom: 40px; }
    .blog-title { font-size: clamp(28px, 5vw, 42px); color: var(--heading); line-height: 1.2; margin-bottom: 16px; font-weight: 700; }
    .blog-meta { display: flex; flex-wrap: wrap; align-items: center; gap: 16px; color: var(--text); font-size: 14px; font-family: var(--font-mono); margin-bottom: 24px; }
    .blog-meta time { color: var(--accent); }
    .blog-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 24px; }
    .blog-tag { font-size: 12px; padding: 4px 12px; border-radius: 20px; background: rgba(100,255,218,0.08); color: var(--accent); font-family: var(--font-mono); }
    .blog-content { color: var(--text-light); line-height: 1.8; font-size: 17px; }
    .blog-content h2 { color: var(--heading); font-size: 24px; margin: 48px 0 16px; font-weight: 600; }
    .blog-content h3 { color: var(--heading); font-size: 20px; margin: 32px 0 12px; font-weight: 600; }
    .blog-content p { margin-bottom: 20px; }
    .blog-content ul, .blog-content ol { margin-bottom: 20px; padding-left: 24px; }
    .blog-content li { margin-bottom: 8px; }
    .blog-content strong { color: var(--heading); font-weight: 600; }
    .blog-content code { font-family: var(--font-mono); font-size: 0.9em; background: var(--bg-light); padding: 2px 6px; border-radius: 4px; color: var(--accent); }
    .blog-content pre { background: var(--bg-light); border: 1px solid var(--card-border); border-radius: 8px; padding: 20px; overflow-x: auto; margin-bottom: 24px; font-size: 14px; line-height: 1.6; }
    .blog-content pre code { background: none; padding: 0; color: var(--text-light); }
    .blog-content a { color: var(--accent); text-decoration: underline; text-underline-offset: 3px; }
    .blog-content a:hover { color: var(--heading); }
    .blog-content table { width: 100%; border-collapse: collapse; margin-bottom: 24px; font-size: 15px; }
    .blog-content th, .blog-content td { padding: 12px 16px; border: 1px solid var(--card-border); text-align: left; }
    .blog-content th { background: var(--bg-light); color: var(--heading); font-weight: 600; }
    .blog-footer { margin-top: 60px; padding-top: 32px; border-top: 1px solid var(--card-border); }
    .blog-author { display: flex; align-items: center; gap: 16px; }
    .blog-author-img { width: 56px; height: 56px; border-radius: 50%; object-fit: cover; }
    .blog-author-info h4 { color: var(--heading); font-size: 16px; }
    .blog-author-info p { color: var(--text); font-size: 14px; }
    .blog-cta { margin-top: 32px; text-align: center; }
    .blog-cta a { display: inline-block; padding: 12px 28px; border: 1px solid var(--accent); color: var(--accent); border-radius: 6px; font-family: var(--font-mono); font-size: 14px; transition: var(--transition); }
    .blog-cta a:hover { background: var(--accent-muted); }
    @media (max-width: 768px) { .blog-post { padding-top: calc(var(--nav-height) + 20px); } .blog-content { font-size: 16px; } }
  </style>
</head>
<body>
  <nav class="nav" id="nav" aria-label="Main navigation">
    <a href="../index.html" class="nav-logo" aria-label="Humza Tareen - Home">HT</a>
    <div class="nav-links" role="list">
      <div class="page-switcher">
        <a href="../engineering.html">Engineering</a>
        <a href="../research.html">Research</a>
      </div>
      <a href="../engineering.html#articles" role="listitem">All Articles</a>
      <a href="../engineering.html#contact" class="nav-cta" role="listitem">Hire Me</a>
    </div>
  </nav>
  <main class="blog-post">
    <a href="../engineering.html#articles" class="blog-back"><i class="fas fa-arrow-left"></i> All Articles</a>
    <article>
      <header class="blog-header">
        <h1 class="blog-title">Building an RL Training Arena for AI Code Agents on GCP</h1>
        <div class="blog-meta">
          <time datetime="2026-02-08">Feb 8, 2026</time>
          <span>&middot;</span>
          <span>7 min read</span>
          <span>&middot;</span>
          <span>Humza Tareen</span>
        </div>
        <div class="blog-tags">
          <span class="blog-tag">Reinforcement Learning</span>
          <span class="blog-tag">AI</span>
          <span class="blog-tag">GKE</span>
          <span class="blog-tag">Cloud Build</span>
          <span class="blog-tag">Python</span>
        </div>
      </header>
      <div class="blog-content">
        
        <p>How do you teach an AI to get better at coding? Not with more training data — with structured feedback. Give it a task, let it try, measure the result, and let it learn. I built the environment that makes this possible.</p>

        <h2>The Gym-Style API</h2>
        <p>We modeled after OpenAI Gym because RL researchers already know this interface. Three endpoints capture the full RL loop: create episode, execute step, compute reward. The API abstracts away the complexity of code execution, sandboxing, and state management. Here's what it looks like:</p>

<pre><code>POST /episodes
{
  "task_id": "fix-bug-in-sort-function",
  "agent_id": "claude-sonnet-4"
}

POST /episodes/{episode_id}/steps
{
  "action": "edit_file",
  "file": "src/sort.py",
  "code": "def sort(arr): ..."
}

GET /episodes/{episode_id}/reward
{
  "reward": 0.75,
  "tests_passed": 3,
  "total_tests": 4
}</code></pre>

        <p>This interface lets researchers focus on agent behavior, not infrastructure. They don't need to know about Cloud Build, Redis, or Firestore—they just need to understand episodes, steps, and rewards.</p>

        <h2>Sandboxing Untrusted Code</h2>
        <p>Agents execute arbitrary code. You need isolation. Cloud Build provides containers with no network, hard timeouts, resource limits, and read-only filesystems. The trade-off: roughly 10 seconds of startup latency per execution. Worth it for guaranteed isolation. Each agent execution happens in an isolated Cloud Build step. No cross-contamination between evaluations, no way for one agent's code to affect another's environment.</p>

        <h2>State Management Tiers</h2>
        <p>We use three storage tiers, each chosen for its access pattern. Redis holds ephemeral episode state—fast read/write, perfect for the active episode that needs sub-second updates. Episodes are short-lived, but they need to be fast. Firestore stores persistent trajectories—training data that needs to persist long-term and be queryable. Researchers need to analyze agent behavior over time, compare trajectories, and extract patterns. Cloud SQL holds task configuration—relational data that needs JOINs and complex queries. Task definitions, verifiers, baseline results—all structured data that belongs in a relational database.</p>

        <p>Don't just list them—understand WHY each tier exists. Redis isn't just "fast"—it's for data that doesn't need to survive a restart. Firestore isn't just "persistent"—it's for data that needs real-time listeners and flexible schemas. Cloud SQL isn't just "relational"—it's for data that needs ACID guarantees and complex queries.</p>

        <h2>The Preprocessor Pipeline</h2>
        <p>Think of it as the task chef. Raw ingredients go in—a GitHub repository, a task description, maybe some baseline tests. A fully prepared training environment comes out. The 15-step preprocessing workflow analyzes repositories, generates verifiers, establishes baselines, creates test harnesses, and configures reward functions. Dynamic verifier and reward configuration generation means each task gets a custom evaluation setup. Repository analysis extracts dependencies, identifies test patterns, and builds execution contexts. Baseline test execution establishes ground truth—what should pass before the agent even starts.</p>

        <h2>Reward Shaping</h2>
        <p>Here's the reward formula:</p>

<pre><code>reward = (tests_passed / total_tests) * base_reward
        + style_bonus
        - time_penalty
        - error_penalty</code></pre>

        <p>Getting the reward shaping right took three iterations. Too sparse—agents don't learn because they rarely get positive feedback. Too dense—agents game the metric, optimizing for the reward function instead of solving the task. Just right—balances test passage, style, time, and errors in a way that encourages genuine problem-solving.</p>

        <h2>Architecture Choice: Hexagonal</h2>
        <p>Domain logic is decoupled from GCP infrastructure. Switching Cloud Build for local Docker? Change the adapter, not the domain. This isn't academic—it made testing actually possible. We can run the entire RL loop locally without spinning up Cloud Build containers. The domain doesn't know about GCP. It knows about code execution, state management, and reward computation. The infrastructure adapters handle the details.</p>
        
      </div>
      <footer class="blog-footer">
        <div class="blog-author">
          <img src="../suit-blue-bg.jpg" alt="Humza Tareen" class="blog-author-img">
          <div class="blog-author-info">
            <h4>Humza Tareen</h4>
            <p>AI Engineer building production systems at scale. <a href="../engineering.html">View full portfolio</a></p>
          </div>
        </div>
        <div class="blog-cta">
          <a href="../engineering.html#articles">Read More Articles</a>
        </div>
      </footer>
    </article>
  </main>
</body>
</html>